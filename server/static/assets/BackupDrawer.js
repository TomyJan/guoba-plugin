var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,s=(e,t)=>{for(var n in t||(t={}))a.call(t,n)&&o(e,n,t[n]);if(r)for(var n of r(t))i.call(t,n)&&o(e,n,t[n]);return e},l=(e,t,n)=>new Promise(((r,a)=>{var i=e=>{try{s(n.next(e))}catch(t){a(t)}},o=e=>{try{s(n.throw(e))}catch(t){a(t)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(i,o);s((n=n.apply(e,t)).next())}));import{B as c,a as p}from"./index31.js";import{a as d,b as u,B as m,r as f,I as y,s as b,e as g,o as v,i as j,j as w,k as h,v as O,l as k,m as P,f as C,V as _,a4 as x,a5 as D,aL as I,u as L}from"./index.js";import"./PathSelect.js";import{f as B,h as S,r as A,i as R}from"./miao.api.js";import"./index10.js";import"./ArrowLeftOutlined.js";import"./index2.js";import"./useWindowSizeFn.js";import"./FullscreenOutlined.js";import"./index3.js";import"./base64Conver.js";const z=u({name:"BackupDrawer",components:{BasicDrawer:c},emits:["register","reload"],setup(e,{emit:r}){const a=m(),{createMessage:i,createConfirm:o}=I(),{createPrompt:c}=L(),d=f(!1),u=f([]),[g,{closeDrawer:v,setDrawerProps:j}]=p((function(){w()}));function w(){return l(this,null,(function*(){try{O(!0),u.value=(yield B()).reverse()}finally{O(!1)}}))}function h(){v()}function O(e){d.value=e,j({confirmLoading:e})}return{getProps:y((()=>{let r={width:document.body.clientWidth>=768?700:"100%",title:"喵喵帮助备份",confirmLoading:b(d)};var i;return i=s(s(s({},b(a)),r),e),t(i,n({onOk:h,onCancel:h,onRegister:g}))})),loading:d,backupList:u,onAdd:function(){c({title:"新增备份",required:!0,placeholder:"请输入备份名称",bottomHelpMessage:"注：新版备份只会备份配置和图标，背景图片请使用“皮肤”功能。",onOk(e){return l(this,null,(function*(){yield S(e),yield w()}))}})},onRollback:function(e){return l(this,null,(function*(){let t=!1;if(2===e.version||(t=yield new Promise((e=>{o({iconType:"warning",title:"备份版本过低",content:"当前备份为旧版备份，是否要转换为新版备份？",onOk:()=>e(!0),onCancel:()=>e(!1)})})),t))try{O(!0),yield A(e.id),t&&(yield w()),r("reload")}finally{O(!1)}}))},onDelete:function(e){return l(this,null,(function*(){try{O(!0),yield R(e.id),yield w()}finally{O(!1)}}))}}}}),F={style:{"margin-bottom":"8px"}},M={key:0,class:"remark-old"};var W=d(z,[["render",function(e,t,n,r,a,i){const o=g("a-button"),s=g("a-popconfirm"),l=g("a-list-item-meta"),c=g("a-list-item"),p=g("a-list"),d=g("a-spin"),u=g("BasicDrawer");return v(),j(u,x(D(e.getProps)),{default:w((()=>[h(d,{wrapperClassName:"p-2",spinning:e.loading},{default:w((()=>[O("div",F,[h(o,{type:"primary",preIcon:"ant-design:plus",onClick:e.onAdd},{default:w((()=>[k("新增备份")])),_:1},8,["onClick"])]),h(p,{size:"large",bordered:"",dataSource:e.backupList},{renderItem:w((({item:t})=>[h(c,null,{actions:w((()=>[h(s,{title:"确定要还原吗？",placement:"left",onConfirm:()=>e.onRollback(t)},{default:w((()=>[h(o,{type:"primary",shape:"circle",preIcon:"ant-design:undo"})])),_:2},1032,["onConfirm"]),h(s,{title:"确定要删除吗？",placement:"left",onConfirm:()=>e.onDelete(t)},{default:w((()=>[h(o,{type:"primary",shape:"circle",danger:"",preIcon:"ant-design:delete"})])),_:2},1032,["onConfirm"])])),default:w((()=>[h(l,{description:t.time},{title:w((()=>[O("span",null,P(t.remark),1),2!==t.version?(v(),C("span",M,"OLD")):_("",!0)])),_:2},1032,["description"])])),_:2},1024)])),_:1},8,["dataSource"])])),_:1},8,["spinning"])])),_:1},16)}],["__scopeId","data-v-c49cc470"]]);export{W as default};
