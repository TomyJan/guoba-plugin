import{b as t,r as e,I as o,o as r,i as s,j as a,c$ as i,cY as n,a4 as m,a5 as l,ax as p,x as u,aL as j}from"./index.js";import{a as d}from"./hooks.js";import f from"./Step1-1.js";import c from"./Step1-2.js";import v from"./Step1-3.js";import x from"./Step1-4.js";import{a as h}from"./common.js";import{l as S}from"./lodash.default.js";import"./BasicForm.js";import"./index4.js";import"./index5.js";import"./useFormItem.js";import"./index3.js";import"./DeleteOutlined.js";import"./transButton.js";import"./index2.js";import"./useWindowSizeFn.js";import"./FullscreenOutlined.js";import"./upperFirst.js";import"./download.js";import"./index6.js";import"./index7.js";import"./uniqBy.js";import"./PathSelect.js";import"./ModeBox.js";import"./StepBtn.js";import"./throttle.js";import"./merge.js";const y=t({__name:"Step1",setup(t){const{createMessage:y,createConfirm:g,createWarningModal:w}=j(),[,{models:B,stepStore:F}]=d({},{}),P=e(0),k=[f,c,v,x],I=o((()=>({onPrev:M,onNext:O})));function M(){let t=P.value-1;2===t&&"full"===B.value.mode&&t--,t<0?y.warn("已是第一步"):P.value=t}function O(){let t=P.value+1;if(2===t&&"full"===B.value.mode&&t++,t===k.length){g({title:"开始迁移",iconType:"warning",content:"你已完成所有的准备工作，请确认是否全部配置正确，并开始迁移吗？",okText:"开始迁移",onOk(){return t=this,e=null,o=function*(){yield u.post({url:"/v2-transfer/start",params:{config:S.omit(B.value,"jsPluginInfo")}});for(let t=0;t<3;t++){if(yield F.updateStatus(),0!==F.status.state)return;yield h(300)}w({title:"错误",content:"获取启动状态失败，请手动刷新页面重试"})},new Promise(((r,s)=>{var a=t=>{try{n(o.next(t))}catch(e){s(e)}},i=t=>{try{n(o.throw(t))}catch(e){s(e)}},n=t=>t.done?r(t.value):Promise.resolve(t.value).then(a,i);n((o=o.apply(t,e)).next())}));var t,e,o}})}else P.value=t}return(t,e)=>(r(),s(p,{name:"fade-slide",appear:""},{default:a((()=>[(r(),s(i,null,[(r(),s(n(k[P.value]),m(l(I.value)),null,16))],1024))])),_:1}))}});export{y as default};
