import{cP as e,a,o as l,f as t,N as s,cQ as n,v as o,m as r,O as i,W as h,e as c,k as u,i as d,V as v,av as g,b as p,U as b,c as m,r as f,I as C,aI as w,w as x,s as y,j as $,cR as k}from"./index.js";import{t as L}from"./throttle.js";function D(a,l){var t,s=a&&a.a;!(t=a&&a.hsl?e(a.hsl):a&&a.hex&&a.hex.length>0?e(a.hex):a&&a.hsv?e(a.hsv):a&&a.rgba?e(a.rgba):a&&a.rgb?e(a.rgb):e(a))||void 0!==t._a&&null!==t._a||t.setAlpha(s||1);var n=t.toHsl(),o=t.toHsv();return 0===n.s&&(o.h=n.h=a.h||a.hsl&&a.hsl.h||l||0),{hsl:n,hex:t.toHexString().toUpperCase(),hex8:t.toHex8String().toUpperCase(),rgba:t.toRgb(),hsv:o,oldHue:a.h||l||n.h,source:a.source,a:a.a||t.getAlpha()}}var M={props:["value"],data(){return{val:D(this.value)}},computed:{colors:{get(){return this.val},set(e){this.val=e,this.$emit("input",e)}}},watch:{value(e){this.val=D(e)}},methods:{colorChange(e,a){this.oldHue=this.colors.hsl.h,this.colors=D(e,a||this.oldHue)},isValidHex:a=>e(a).isValid(),simpleCheckForValidColor(e){for(var a=["r","g","b","a","h","s","l","v"],l=0,t=0,s=0;s<a.length;s++){var n=a[s];e[n]&&(l++,isNaN(e[n])||t++)}if(l===t)return e},paletteUpperCase:e=>e.map((e=>e.toUpperCase())),isTransparent:a=>0===e(a).getAlpha()}};const E={class:"vc-editable-input"},S=["aria-labelledby"],U=["for","id"],_={class:"vc-input__desc"};var H=a({name:"editableInput",props:{label:String,labelText:String,desc:String,value:[String,Number],max:Number,min:Number,arrowOffset:{type:Number,default:1}},computed:{val:{get(){return this.value},set(e){if(void 0===this.max)return e;+e>this.max?this.$refs.input.value=this.max:+e<this.min&&(this.$refs.input.value=this.min)}},labelId(){return`input__label__${this.label}__${Math.random().toString().slice(2,5)}`},labelSpanText(){return this.labelText||this.label}},methods:{update(e){this.handleChange(e.target.value)},handleChange(e){let a={};a[this.label]=e,(void 0===a.hex&&void 0===a["#"]||e.length>5)&&this.$emit("change",a)},handleKeyDown(e){let a=this.val,l=Number(a);if(l){let t=this.arrowOffset||1;38===e.keyCode&&(a=l+t,this.handleChange(a),e.preventDefault()),40===e.keyCode&&(a=l-t,this.handleChange(a),e.preventDefault())}}}},[["render",function(e,a,i,h,c,u){return l(),t("div",E,[s(o("input",{"aria-labelledby":u.labelId,class:"vc-input__input","onUpdate:modelValue":a[0]||(a[0]=e=>u.val=e),onKeydown:a[1]||(a[1]=(...e)=>u.handleKeyDown&&u.handleKeyDown(...e)),onInput:a[2]||(a[2]=(...e)=>u.update&&u.update(...e)),ref:"input"},null,40,S),[[n,u.val]]),o("span",{for:i.label,class:"vc-input__label",id:u.labelId},r(u.labelSpanText),9,U),o("span",_,r(i.desc),1)])}]]),I=function(e,a,l){return a<l?e<a?a:e>l?l:e:e<l?l:e>a?a:e};const A={name:"Saturation",props:{value:Object},computed:{colors(){return this.value},bgColor(){return`hsl(${this.colors.hsv.h}, 100%, 50%)`},pointerTop(){return-100*this.colors.hsv.v+1+100+"%"},pointerLeft(){return 100*this.colors.hsv.s+"%"}},methods:{throttle:L(((e,a)=>{e(a)}),20,{leading:!0,trailing:!1}),handleChange(e,a){!a&&e.preventDefault();var l=this.$refs.container;if(l){var t=l.clientWidth,s=l.clientHeight,n=l.getBoundingClientRect().left+window.pageXOffset,o=l.getBoundingClientRect().top+window.pageYOffset,r=e.pageX||(e.touches?e.touches[0].pageX:0),i=e.pageY||(e.touches?e.touches[0].pageY:0),h=I(r-n,0,t),c=I(i-o,0,s),u=h/t,d=I(-c/s+1,0,1);this.throttle(this.onChange,{h:this.colors.hsv.h,s:u,v:d,a:this.colors.hsv.a,source:"hsva"})}},onChange(e){this.$emit("change",e)},handleMouseDown(e){window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(e){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}},T=o("div",{class:"vc-saturation--white"},null,-1),F=o("div",{class:"vc-saturation--black"},null,-1),N=[o("div",{class:"vc-saturation-circle"},null,-1)];var O=a(A,[["render",function(e,a,s,n,r,h){return l(),t("div",{class:"vc-saturation",style:i({background:h.bgColor}),ref:"container",onMousedown:a[0]||(a[0]=(...e)=>h.handleMouseDown&&h.handleMouseDown(...e)),onTouchmove:a[1]||(a[1]=(...e)=>h.handleChange&&h.handleChange(...e)),onTouchstart:a[2]||(a[2]=(...e)=>h.handleChange&&h.handleChange(...e))},[T,F,o("div",{class:"vc-saturation-pointer",style:i({top:h.pointerTop,left:h.pointerLeft})},N,4)],36)}]]);const R={name:"Hue",props:{value:Object,direction:{type:String,default:"horizontal"}},data:()=>({oldHue:0,pullDirection:""}),computed:{colors(){const e=this.value.hsl.h;return 0!==e&&e-this.oldHue>0&&(this.pullDirection="right"),0!==e&&e-this.oldHue<0&&(this.pullDirection="left"),this.oldHue=e,this.value},directionClass(){return{"vc-hue--horizontal":"horizontal"===this.direction,"vc-hue--vertical":"vertical"===this.direction}},pointerTop(){return"vertical"===this.direction?0===this.colors.hsl.h&&"right"===this.pullDirection?0:-100*this.colors.hsl.h/360+100+"%":0},pointerLeft(){return"vertical"===this.direction?0:0===this.colors.hsl.h&&"right"===this.pullDirection?"100%":100*this.colors.hsl.h/360+"%"}},methods:{handleChange(e,a){!a&&e.preventDefault();var l=this.$refs.container;if(l){var t,s=l.clientWidth,n=l.clientHeight,o=l.getBoundingClientRect().left+window.pageXOffset,r=l.getBoundingClientRect().top+window.pageYOffset,i=(e.pageX||(e.touches?e.touches[0].pageX:0))-o,h=(e.pageY||(e.touches?e.touches[0].pageY:0))-r;"vertical"===this.direction?(t=h<0?360:h>n?0:360*(-100*h/n+100)/100,this.colors.hsl.h!==t&&this.$emit("change",{h:t,s:this.colors.hsl.s,l:this.colors.hsl.l,a:this.colors.hsl.a,source:"hsl"})):(t=i<0?0:i>s?360:360*(100*i/s)/100,this.colors.hsl.h!==t&&this.$emit("change",{h:t,s:this.colors.hsl.s,l:this.colors.hsl.l,a:this.colors.hsl.a,source:"hsl"}))}},handleMouseDown(e){this.handleChange(e,!0),window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(e){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}},j=["aria-valuenow"],B=[o("div",{class:"vc-hue-picker"},null,-1)];var X=a(R,[["render",function(e,a,s,n,r,c){return l(),t("div",{class:h(["vc-hue",c.directionClass])},[o("div",{class:"vc-hue-container",role:"slider","aria-valuenow":c.colors.hsl.h,"aria-valuemin":"0","aria-valuemax":"360",ref:"container",onMousedown:a[0]||(a[0]=(...e)=>c.handleMouseDown&&c.handleMouseDown(...e)),onTouchmove:a[1]||(a[1]=(...e)=>c.handleChange&&c.handleChange(...e)),onTouchstart:a[2]||(a[2]=(...e)=>c.handleChange&&c.handleChange(...e))},[o("div",{class:"vc-hue-pointer",style:i({top:c.pointerTop,left:c.pointerLeft}),role:"presentation"},B,4)],40,j)],2)}]]);let V={};function Y(e,a,l){var t=e+","+a+","+l;if(V[t])return V[t];var s=function(e,a,l){if("undefined"==typeof document)return null;var t=document.createElement("canvas");t.width=t.height=2*l;var s=t.getContext("2d");return s?(s.fillStyle=e,s.fillRect(0,0,t.width,t.height),s.fillStyle=a,s.fillRect(0,0,l,l),s.translate(l,l),s.fillRect(0,0,l,l),t.toDataURL()):null}(e,a,l);return V[t]=s,s}var z=a({name:"Checkboard",props:{size:{type:[Number,String],default:8},white:{type:String,default:"#fff"},grey:{type:String,default:"#e6e6e6"}},computed:{bgStyle(){return{"background-image":"url("+Y(this.white,this.grey,this.size)+")"}}}},[["render",function(e,a,s,n,o,r){return l(),t("div",{class:"vc-checkerboard",style:i(r.bgStyle)},null,4)}]]);const K={name:"Alpha",props:{value:Object,onChange:Function},components:{checkboard:z},computed:{colors(){return this.value},gradientColor(){var e=this.colors.rgba,a=[e.r,e.g,e.b].join(",");return"linear-gradient(to right, rgba("+a+", 0) 0%, rgba("+a+", 1) 100%)"}},methods:{handleChange(e,a){!a&&e.preventDefault();var l=this.$refs.container;if(l){var t,s=l.clientWidth,n=l.getBoundingClientRect().left+window.pageXOffset,o=(e.pageX||(e.touches?e.touches[0].pageX:0))-n;t=o<0?0:o>s?1:Math.round(100*o/s)/100,this.colors.a!==t&&this.$emit("change",{h:this.colors.hsl.h,s:this.colors.hsl.s,l:this.colors.hsl.l,a:t,source:"rgba"})}},handleMouseDown(e){this.handleChange(e,!0),window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}},P={class:"vc-alpha"},W={class:"vc-alpha-checkboard-wrap"},G=[o("div",{class:"vc-alpha-picker"},null,-1)];const Q={name:"Chrome",mixins:[M],props:{disableAlpha:{type:Boolean,default:!1},disableFields:{type:Boolean,default:!1}},components:{saturation:O,hue:X,alpha:a(K,[["render",function(e,a,s,n,r,h){const d=c("checkboard");return l(),t("div",P,[o("div",W,[u(d)]),o("div",{class:"vc-alpha-gradient",style:i({background:h.gradientColor})},null,4),o("div",{class:"vc-alpha-container",ref:"container",onMousedown:a[0]||(a[0]=(...e)=>h.handleMouseDown&&h.handleMouseDown(...e)),onTouchmove:a[1]||(a[1]=(...e)=>h.handleChange&&h.handleChange(...e)),onTouchstart:a[2]||(a[2]=(...e)=>h.handleChange&&h.handleChange(...e))},[o("div",{class:"vc-alpha-pointer",style:i({left:100*h.colors.a+"%"})},G,4)],544)])}]]),"ed-in":H,CheckBoard:z},data:()=>({fieldsIndex:1,highlight:!1}),computed:{hsl(){const{h:e,s:a,l:l}=this.colors.hsl;return{h:e.toFixed(),s:`${(100*a).toFixed()}%`,l:`${(100*l).toFixed()}%`}},activeColor(){const e=this.colors.rgba;return"rgba("+[e.r,e.g,e.b,e.a].join(",")+")"},hasAlpha(){return this.colors.a<1}},methods:{childChange(e){this.colorChange(e)},inputChange(e){if(e)if(e.hex)this.isValidHex(e.hex)&&this.colorChange({hex:e.hex,source:"hex"});else if(e.r||e.g||e.b||e.a)this.colorChange({r:e.r||this.colors.rgba.r,g:e.g||this.colors.rgba.g,b:e.b||this.colors.rgba.b,a:e.a||this.colors.rgba.a,source:"rgba"});else if(e.h||e.s||e.l){const a=e.s?e.s.replace("%","")/100:this.colors.hsl.s,l=e.l?e.l.replace("%","")/100:this.colors.hsl.l;this.colorChange({h:e.h||this.colors.hsl.h,s:a,l:l,source:"hsl"})}},showHighlight(){this.highlight=!0},hideHighlight(){this.highlight=!1}}},q={class:"vc-chrome-saturation-wrap"},J={class:"vc-chrome-body"},Z={class:"vc-chrome-controls"},ee={class:"vc-chrome-color-wrap"},ae=["aria-label"],le={class:"vc-chrome-sliders"},te={class:"vc-chrome-hue-wrap"},se={key:0,class:"vc-chrome-alpha-wrap"},ne={key:0,class:"vc-chrome-fields-wrap"},oe={class:"vc-chrome-fields"},re={class:"vc-chrome-field"},ie={class:"vc-chrome-field"},he={class:"vc-chrome-field"},ce={key:0,class:"vc-chrome-field"};var ue=a(Q,[["render",function(e,a,n,r,p,b){const m=c("saturation"),f=c("CheckBoard"),C=c("hue"),w=c("alpha"),x=c("ed-in");return l(),t("div",{role:"application","aria-label":"Chrome color picker",class:h(["vc-chrome",n.disableAlpha?"vc-chrome__disable-alpha":""])},[o("div",q,[u(m,{value:e.colors,"onUpdate:value":a[0]||(a[0]=a=>e.colors=a),onChange:b.childChange},null,8,["value","onChange"])]),o("div",J,[o("div",Z,[o("div",ee,[o("div",{"aria-label":`current color is ${e.colors.hex}`,class:"vc-chrome-active-color",style:i({background:b.activeColor})},null,12,ae),n.disableAlpha?v("",!0):(l(),d(f,{key:0}))]),o("div",le,[o("div",te,[u(C,{value:e.colors,"onUpdate:value":a[1]||(a[1]=a=>e.colors=a),onChange:b.childChange},null,8,["value","onChange"])]),n.disableAlpha?v("",!0):(l(),t("div",se,[u(w,{value:e.colors,"onUpdate:value":a[2]||(a[2]=a=>e.colors=a),onChange:b.childChange},null,8,["value","onChange"])]))])]),n.disableFields?v("",!0):(l(),t("div",ne,[s(o("div",oe,[o("div",re,[u(x,{label:"r",value:e.colors.rgba.r,onChange:b.inputChange},null,8,["value","onChange"])]),o("div",ie,[u(x,{label:"g",value:e.colors.rgba.g,onChange:b.inputChange},null,8,["value","onChange"])]),o("div",he,[u(x,{label:"b",value:e.colors.rgba.b,onChange:b.inputChange},null,8,["value","onChange"])]),n.disableAlpha?v("",!0):(l(),t("div",ce,[u(x,{label:"a",value:e.colors.a,"arrow-offset":.01,max:1,onChange:b.inputChange},null,8,["value","onChange"])]))],512),[[g,1===p.fieldsIndex]])]))])],2)}]]);const de={class:"vc-chrome-field custom"},ve={class:"vc-chrome-field custom"},ge={class:"vc-chrome-field custom"},pe={key:0,class:"vc-chrome-field custom"},be={class:"vc-chrome-field"},me={class:"vc-color-view"},fe=p({__name:"GColorPicker",props:{value:String},emits:["change"],setup(e,{emit:a}){const s=e,n=a,r={rgb:/rgb\((\d{1,3}), ?(\d{1,3}), ?(\d{1,3})\)/,rgba:/rgba\((\d{1,3}), ?(\d{1,3}), ?(\d{1,3}), ?([10]?\.?\d+)\)/,hex:/#?([0-9a-fA-F]{6}|[0-9a-fA-F]{3})/,hex8:/#([0-9a-fA-F]{8})/},{prefixCls:c}=b("g-color-picker"),d={r:0,g:0,b:0,a:1},g=m({rgba:d,hex8:"#000000FF"}),p=f("rgba"),L=C((()=>g.rgba)),D=C((()=>["rgb","hex"].includes(p.value))),M=w(I,100);function E(e,a=!1){let l;l=a?e.match(r.rgba):e.match(r.rgb),g.rgba.r=parseInt(l[1]),g.rgba.g=parseInt(l[2]),g.rgba.b=parseInt(l[3]),g.rgba.a=a?parseFloat(l[4]):1}function S(e,a=!1){let l,t;if(a){if(l=e.match(r.hex8),t=l[1],8!==t.length)return g.rgba=d,void console.error("hex8 color must be 8 length")}else l=e.match(r.hex),t=l[1],3===t.length&&(t=t.replace(/(.)/g,"$1$1"));g.rgba.r=parseInt(t.slice(0,2),16),g.rgba.g=parseInt(t.slice(2,4),16),g.rgba.b=parseInt(t.slice(4,6),16),g.rgba.a=a?parseInt(t.slice(6,8),16)/255:1}function U(e){console.log("onValueChange:",e),e.hex8&&e.rgba&&(g.rgba=e.rgba,g.hex8=e.hex8,M())}function _(e,a){if(!e.target){for(let[a,l]of Object.entries(e)){let e=parseFloat(l);isNaN(e)&&(e=0),g.rgba[a]=e}M()}}function I(){if("rgb"===p.value){let{r:e,g:a,b:l}=g.rgba;n("change",`rgb(${e}, ${a}, ${l})`)}else if("hex"===p.value){let e=g.hex8;n("change",e.slice(0,7))}else if("hex8"===p.value){let e=g.hex8;n("change",e)}else{let{r:e,g:a,b:l,a:t}=g.rgba;n("change",`rgba(${e}, ${a}, ${l}, ${t})`)}}return x((()=>s.value),(e=>{e?r.rgb.test(e)?(p.value="rgb",E(e)):r.rgba.test(e)?(p.value="rgba",E(e,!0)):r.hex.test(e)?(p.value="hex",S(e)):r.hex8.test(e)?(p.value="hex8",S(e,!0)):(g.rgba=d,I()):(g.rgba=d,I())}),{immediate:!0}),(e,a)=>(l(),t("div",{class:h([y(c),"vc-chrome-fields"])},[o("div",de,[u(y(H),{label:"r",value:L.value.r,min:0,max:255,onChange:_},null,8,["value"])]),o("div",ve,[u(y(H),{label:"g",value:L.value.g,min:0,max:255,onChange:_},null,8,["value"])]),o("div",ge,[u(y(H),{label:"b",value:L.value.b,min:0,max:255,onChange:_},null,8,["value"])]),D.value?v("",!0):(l(),t("div",pe,[u(y(H),{label:"a",value:L.value.a,min:0,max:1,"arrow-offset":.01,onChange:_},null,8,["value"])])),o("div",be,[u(y(k),{trigger:"click",placement:"bottom",getPopupContainer:e=>e.parentNode},{content:$((()=>[u(y(ue),{value:g,onInput:U,disableAlpha:D.value},null,8,["value","disableAlpha"])])),default:$((()=>[o("div",me,[o("div",{style:i(`height:100%;background:rgba(${L.value.r},${L.value.g},${L.value.b},${L.value.a})`)},null,4)])])),_:1},8,["getPopupContainer"])])],2))}});export{fe as default};
